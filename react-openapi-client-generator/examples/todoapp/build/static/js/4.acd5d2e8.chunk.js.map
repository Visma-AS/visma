{"version":3,"sources":["mocks/requestLogicHandlers.ts","mocks/browser.ts","../../../../msw-openapi-backend-integration/lib/main.js"],"names":["definition","require","id","items","paths","get","responses","content","examples","value","requestLogicHandlers","postItem","request","push","body","timestamp","Date","now","_id","String","putItem","item","index","findIndex","params","itemId","putItems","itemUpdates","itemUpdate","deleteItem","splice","deleteItems","worker","setupWorker","options","api","OpenAPIBackend","register","c","res","ctx","status","x","requestLogicHandler","operation","operationId","mockResponseForOperation","mock","json","methods","Object","keys","rest","flatMap","method","servers","map","url","req","path","href","slice","length","handleRequest","handlers"],"mappings":"2OAGaA,EAAaC,EAAQ,KAE9BC,EAAK,EAEHC,EACJH,EAAWI,MAAM,UAAUC,IAAIC,UAAU,KAAOC,QAAQ,oBACrDC,SAAS,aAAaC,MAqCZC,EAnCoC,CACjDC,SADiD,SACxCC,GAELZ,EAAWI,MAAM,UAAUC,IAAIC,UAAU,KAAOC,QAC9C,oBACAC,SAAS,aAAaC,MACpBI,KAAN,2BACMD,EAAQE,MADd,IAEEC,UAAWC,KAAKC,MAChBC,IAAKC,OAAOjB,SAGhBkB,QAZiD,SAYzCR,GACN,IAAMS,EAAOT,EAAQE,KACfQ,EAAQnB,EAAMoB,WAAU,SAACF,GAAD,OAAUA,EAAKH,MAAQN,EAAQY,OAAOC,UACpEtB,EAAMmB,GAASD,GAEjBK,SAjBiD,SAiBxCd,GACP,IADgB,EACVe,EAAcf,EAAQE,KADZ,cAESa,GAFT,yBAELC,EAFK,QAGRN,EAAQnB,EAAMoB,WAAU,SAACF,GAAD,OAAUA,EAAKH,MAAQU,EAAWV,OAChEf,EAAMmB,GAASM,GAFjB,2BAAuC,IAFvB,gCAOlBC,WAxBiD,SAwBtCjB,GACT,IAAMU,EAAQnB,EAAMoB,WAAU,SAACF,GAAD,OAAUA,EAAKH,MAAQN,EAAQY,OAAOC,UACpEtB,EAAM2B,OAAOR,EAAO,IAEtBS,YA5BiD,SA4BrCnB,GAAU,IAAD,gBACFA,EAAQE,MADN,yBACRZ,EADQ,QAEXoB,EAAQnB,EAAMoB,WAAU,SAACF,GAAD,OAAUA,EAAKH,MAAQhB,KACrDC,EAAM2B,OAAOR,EAAO,IAFtB,2BAAgC,IADb,iCCnCVU,EAASC,IAAW,WAAX,cCDf,SAAkBC,GAAoC,IAA3BxB,EAA2B,uDAAJ,GACjDyB,EAAM,IAAIC,IAAeF,GAC/BC,EAAIE,SAAS,YAAY,SAACC,EAAGC,EAAKC,GAAT,OAAiBD,EAAIC,EAAIC,OAAO,SAEzDN,EAAIE,SAAS,kBAAkB,SAACC,EAAGC,EAAKC,EAAKE,GAC3C,IAAMC,EAAsBjC,EAAqB4B,EAAEM,UAAUC,aACzDF,GACFA,EAAoBL,EAAE1B,SAExB,MAAyB0B,EAAEH,IAAIW,yBAC7BR,EAAEM,UAAUC,aADNJ,EAAR,EAAQA,OAAQM,EAAhB,EAAgBA,KAGhB,OAAOR,EAAIC,EAAIC,OAAOA,GAASD,EAAIQ,KAAKD,OAG1C,IAAME,EAAUC,OAAOC,KAAKC,KAE5B,OAAOH,EAAQI,SAAQ,SAACC,GAAD,OACrBpB,EAAQlC,WAAWuD,QAAQC,KAAI,gBAAGC,EAAH,EAAGA,IAAH,OAC7BL,IAAKE,GAAL,UAAgBG,EAAhB,OAAyB,SAACC,EAAKnB,EAAKC,GAElC,OADAkB,EAAIC,KAAOD,EAAID,IAAIG,KAAKC,MAAMJ,EAAIK,QAC3B3B,EAAI4B,cAAcL,EAAKnB,EAAKC,YDnBtCwB,CAAS,CAAEhE,cAAcU","file":"static/js/4.acd5d2e8.chunk.js","sourcesContent":["import { RequestLogicHandlers } from '@visma/msw-openapi-backend-integration';\nimport type { Components } from '../client';\n\nexport const definition = require('../TodoMVC-API.json');\n\nlet id = 0;\n\nconst items: Components.Schemas.Items =\n  definition.paths['/items'].get.responses['200'].content['application/json']\n    .examples['example-1'].value;\n\nconst requestLogicHandlers: RequestLogicHandlers = {\n  postItem(request) {\n    const items =\n      definition.paths['/items'].get.responses['200'].content[\n        'application/json'\n      ].examples['example-1'].value;\n    items.push({\n      ...(request.body as object),\n      timestamp: Date.now(),\n      _id: String(id++),\n    });\n  },\n  putItem(request) {\n    const item = request.body as Components.Schemas.Item;\n    const index = items.findIndex((item) => item._id === request.params.itemId);\n    items[index] = item;\n  },\n  putItems(request) {\n    const itemUpdates = request.body as Components.Schemas.Items;\n    for (const itemUpdate of itemUpdates) {\n      const index = items.findIndex((item) => item._id === itemUpdate._id);\n      items[index] = itemUpdate;\n    }\n  },\n  deleteItem(request) {\n    const index = items.findIndex((item) => item._id === request.params.itemId);\n    items.splice(index, 1);\n  },\n  deleteItems(request) {\n    for (const id of request.body) {\n      const index = items.findIndex((item) => item._id === id);\n      items.splice(index, 1);\n    }\n  },\n};\nexport default requestLogicHandlers;\n","import { setupWorker } from 'msw';\nimport { handlers } from '@visma/msw-openapi-backend-integration';\nimport requestLogicHandlers, { definition } from './requestLogicHandlers';\n\nexport const worker = setupWorker(\n  ...handlers({ definition }, requestLogicHandlers)\n);\n","import { rest } from 'msw';\nimport OpenAPIBackend from 'openapi-backend';\n\nexport function handlers(options, requestLogicHandlers = {}) {\n  const api = new OpenAPIBackend(options);\n  api.register('notFound', (c, res, ctx) => res(ctx.status(404)));\n\n  api.register('notImplemented', (c, res, ctx, x) => {\n    const requestLogicHandler = requestLogicHandlers[c.operation.operationId];\n    if (requestLogicHandler) {\n      requestLogicHandler(c.request);\n    }\n    const { status, mock } = c.api.mockResponseForOperation(\n      c.operation.operationId\n    );\n    return res(ctx.status(status), ctx.json(mock));\n  });\n\n  const methods = Object.keys(rest);\n\n  return methods.flatMap((method) =>\n    options.definition.servers.map(({ url }) =>\n      rest[method](`${url}/*`, (req, res, ctx) => {\n        req.path = req.url.href.slice(url.length);\n        return api.handleRequest(req, res, ctx);\n      })\n    )\n  );\n}\n"],"sourceRoot":""}